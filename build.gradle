plugins {
    id 'org.jetbrains.intellij' version '0.6.5' apply false
}
allprojects {
    apply plugin: 'java'
    apply plugin: 'org.jetbrains.intellij'
    sourceCompatibility = 1.8
    targetCompatibility = 1.8
    repositories {
        mavenCentral()
    }
    intellij {
        version sdkVersion
        updateSinceUntilBuild false
    }
    tasks.withType(JavaCompile) {
        options.encoding = "UTF-8"
    }
}
group 'tk.cofedream.plugin'
version pluginVersion

task cleanJar(type: Delete,dependsOn: [':common:clean',':mbsp:clean',':core:clean'])
task copyJar(type: Copy,dependsOn:[':common:jar',':mbsp:jar',':core:jar']) {
    from 'common/build/libs','mbsp/build/libs','core/build/libs'
    into('build/zip/'+pluginName+'/lib')
}
task preRelease(type: Zip,dependsOn:['cleanJar','copyJar']){
    from 'build/zip'
    destinationDir file('/')
    baseName pluginName
    version pluginVersion
    extension 'zip'
    doLast {
        delete 'common/build','mbsp/build','core/build'
    }
}